{"paragraphs":[{"text":"import sys\nreload(sys)\nsys.setdefaultencoding('utf8')","user":"anonymous","dateUpdated":"2023-05-11T01:35:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<module 'sys' (built-in)>\n"}]},"apps":[],"jobName":"paragraph_1683768937653_931388981","id":"20230511-013537_1229265928","dateCreated":"2023-05-11T01:35:37+0000","dateStarted":"2023-05-11T01:35:39+0000","dateFinished":"2023-05-11T01:35:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:30629"},{"text":"import pyspark.sql.functions as F\nfrom pyspark.sql import SparkSession\nfrom pyspark.ml import Pipeline\n\n\nspark = SparkSession.builder\\\n    .appName(\"BDT Project\")\\\n    .master(\"local[*]\")\\\n    .config(\"hive.metastore.uris\", \"thrift://sandbox-hdp.hortonworks.com:9083\")\\\n    .config(\"spark.sql.catalogImplementation\",\"hive\")\\\n    .config(\"spark.sql.avro.compression.codec\", \"snappy\")\\\n    .config(\"spark.jars\", \"file:///usr/hdp/current/hive-client/lib/hive-metastore-1.2.1000.2.6.5.0-292.jar,file:///usr/hdp/current/hive-client/lib/hive-exec-1.2.1000.2.6.5.0-292.jar\")\\\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-avro_2.12:3.0.3\")\\\n    .enableHiveSupport()\\\n    .getOrCreate()\n\n\nsc = spark.sparkContext\nsc.setLogLevel('WARN')","user":"anonymous","dateUpdated":"2023-05-11T00:03:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1683763354855_-1806114171","id":"20230511-000234_1873130836","dateCreated":"2023-05-11T00:02:34+0000","dateStarted":"2023-05-11T00:03:59+0000","dateFinished":"2023-05-11T00:03:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30630"},{"text":"spark.sql('''\nSELECT category_code, AVG(funding_total_usd) / 1000000 AS avg_funding_m, COUNT(funding_total_usd) AS funding_count\nFROM projectdb.objects\nWHERE entity_type = 'Company' AND funding_total_usd != 0\nGROUP BY category_code\nORDER BY avg_funding_m DESC;\n''').show(10, vertical=True)","user":"anonymous","dateUpdated":"2023-05-11T02:22:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"... ... ... ... ... ... \n[Stage 609:============================>                            (2 + 1) / 4]\n\n[Stage 609:==========================================>              (3 + 1) / 4]\n\n                                                                                \n-RECORD 0---------------------------\n category_code | automotive         \n avg_funding_m | 48.57055064864865  \n funding_count | 74                 \n-RECORD 1---------------------------\n category_code | nanotech           \n avg_funding_m | 39.27800754545455  \n funding_count | 55                 \n-RECORD 2---------------------------\n category_code | cleantech          \n avg_funding_m | 39.17952745390071  \n funding_count | 987                \n-RECORD 3---------------------------\n category_code | government         \n avg_funding_m | 27.442611111111113 \n funding_count | 9                  \n-RECORD 4---------------------------\n category_code | network_hosting    \n avg_funding_m | 27.273072253863134 \n funding_count | 453                \n-RECORD 5---------------------------\n category_code | semiconductor      \n avg_funding_m | 25.933743567441862 \n funding_count | 430                \n-RECORD 6---------------------------\n category_code | transportation     \n avg_funding_m | 21.927376935064935 \n funding_count | 77                 \n-RECORD 7---------------------------\n category_code | biotech            \n avg_funding_m | 20.782941338491295 \n funding_count | 3102               \n-RECORD 8---------------------------\n category_code | medical            \n avg_funding_m | 20.083724767830045 \n funding_count | 659                \n-RECORD 9---------------------------\n category_code | security           \n avg_funding_m | 19.1890902425876   \n funding_count | 371                \nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1683764933248_-783199306","id":"20230511-002853_2074691209","dateCreated":"2023-05-11T00:28:53+0000","dateStarted":"2023-05-11T02:22:13+0000","dateFinished":"2023-05-11T02:22:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30631"},{"text":"spark.sql('''\nSELECT country_code, AVG(funding_total_usd) / 1000000 AS avg_funding_m, COUNT(funding_total_usd) FROM projectdb.objects\nWHERE entity_type = 'Company' AND funding_total_usd != 0\nGROUP BY country_code\n''').show(10, vertical=True)","user":"anonymous","dateUpdated":"2023-05-11T01:02:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"... ... ... ... \n[Stage 185:============================>                            (2 + 1) / 4]\n\n[Stage 185:==========================================>              (3 + 1) / 4]\n\n                                                                                \n-RECORD 0---------------------------------------\n country_code             | POL                 \n avg_funding_m            | 1.8098628536585366  \n count(funding_total_usd) | 41                  \n-RECORD 1---------------------------------------\n country_code             | LVA                 \n avg_funding_m            | 0.20822666666666664 \n count(funding_total_usd) | 3                   \n-RECORD 2---------------------------------------\n country_code             | BRB                 \n avg_funding_m            | 0.798679            \n count(funding_total_usd) | 1                   \n-RECORD 3---------------------------------------\n country_code             | ZMB                 \n avg_funding_m            | 4.0                 \n count(funding_total_usd) | 1                   \n-RECORD 4---------------------------------------\n country_code             | BRA                 \n avg_funding_m            | 9.045934016393442   \n count(funding_total_usd) | 122                 \n-RECORD 5---------------------------------------\n country_code             | JOR                 \n avg_funding_m            | 2.69791875          \n count(funding_total_usd) | 8                   \n-RECORD 6---------------------------------------\n country_code             | FRA                 \n avg_funding_m            | 7.3404756437699685  \n count(funding_total_usd) | 626                 \n-RECORD 7---------------------------------------\n country_code             | SOM                 \n avg_funding_m            | 2.0                 \n count(funding_total_usd) | 1                   \n-RECORD 8---------------------------------------\n country_code             | URY                 \n avg_funding_m            | 0.244               \n count(funding_total_usd) | 5                   \n-RECORD 9---------------------------------------\n country_code             | GIB                 \n avg_funding_m            | 18.929912           \n count(funding_total_usd) | 1                   \nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1683766959772_-398955580","id":"20230511-010239_1747164260","dateCreated":"2023-05-11T01:02:39+0000","dateStarted":"2023-05-11T01:02:52+0000","dateFinished":"2023-05-11T01:03:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30632"},{"text":"# x - money, y - employees\nspark.sql('''\nWITH empl_by_com AS\n(\n    SELECT relationship_object_id as company_id, COUNT(*) as employees FROM projectdb.relationships\n    GROUP BY relationship_object_id\n), companies AS \n(\n    SELECT * FROM projectdb.objects\n    WHERE entity_type = 'Company'\n)\n\nSELECT e.*, c.funding_total_usd FROM empl_by_com AS e\nJOIN companies AS c ON e.company_id = c.id;\n''').show(10, vertical=True)","user":"anonymous","dateUpdated":"2023-05-11T00:46:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"... ... ... ... ... ... ... ... ... ... ... ... ... ... \n[Stage 116:>                                                        (0 + 4) / 4]\n\n[Stage 116:==========================================>              (3 + 1) / 4]\n\n                                                                                \n-RECORD 0------------------------\n company_id        | c:1         \n employees         | 17          \n funding_total_usd | 39750000.00 \n-RECORD 1------------------------\n company_id        | c:10        \n employees         | 6           \n funding_total_usd | 0.00        \n-RECORD 2------------------------\n company_id        | c:100       \n employees         | 12          \n funding_total_usd | 0.00        \n-RECORD 3------------------------\n company_id        | c:10002     \n employees         | 2           \n funding_total_usd | 0.00        \n-RECORD 4------------------------\n company_id        | c:100042    \n employees         | 1           \n funding_total_usd | 0.00        \n-RECORD 5------------------------\n company_id        | c:100174    \n employees         | 2           \n funding_total_usd | 0.00        \n-RECORD 6------------------------\n company_id        | c:10005     \n employees         | 2           \n funding_total_usd | 0.00        \n-RECORD 7------------------------\n company_id        | c:100062    \n employees         | 2           \n funding_total_usd | 0.00        \n-RECORD 8------------------------\n company_id        | c:10009     \n employees         | 2           \n funding_total_usd | 0.00        \n-RECORD 9------------------------\n company_id        | c:1001      \n employees         | 11          \n funding_total_usd | 5000000.00  \nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1683765447223_1668371424","id":"20230511-003727_1737059966","dateCreated":"2023-05-11T00:37:27+0000","dateStarted":"2023-05-11T00:46:10+0000","dateFinished":"2023-05-11T00:46:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30633"},{"text":"spark.sql('''\nWITH companies AS \n(\n    SELECT * FROM projectdb.objects\n    WHERE entity_type = 'Company'\n), count_by_degree AS (\n    SELECT degree_type, COUNT(*) AS count\n    FROM projectdb.degrees\n    GROUP BY degree_type\n    ORDER BY count DESC\n    LIMIT 30\n), funds_by_degree AS(\n    SELECT d.degree_type, SUM(c.funding_total_usd) AS count_fundrasings\n    FROM projectdb.relationships AS r\n    JOIN projectdb.degrees AS d ON r.person_object_id = d.object_id\n    JOIN companies AS c ON r.relationship_object_id = c.id\n    WHERE c.funding_total_usd != 0\n    GROUP BY d.degree_type\n)\nSELECT c.degree_type, count_fundrasings / count AS avg_degree_fundings FROM count_by_degree AS c\nJOIN funds_by_degree AS f ON c.degree_type = f.degree_type\nORDER BY avg_degree_fundings DESC\n''').show(10, vertical=True)","user":"anonymous","dateUpdated":"2023-05-11T01:49:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... \n[Stage 456:>                (0 + 4) / 4][Stage 457:>                (0 + 4) / 4]\n\n                                                                                \n\n[Stage 460:========>        (2 + 1) / 4][Stage 461:>                (0 + 4) / 4]\n\n[Stage 460:========>        (2 + 1) / 4][Stage 461:====>            (1 + 3) / 4]\n\n[Stage 460:============================>                            (2 + 1) / 4]\n\n[Stage 460:==========================================>              (3 + 1) / 4]\n\n[Stage 462:=================>                                    (64 + 8) / 200]\n\n[Stage 462:========================>                             (90 + 8) / 200]\n\n[Stage 462:===============================>                     (120 + 8) / 200]\n\n[Stage 462:========================================>            (154 + 8) / 200]\n\n[Stage 462:================================================>    (184 + 9) / 200]\n\n                                                                                \n-RECORD 0-----------------------------------\n degree_type         | MSE                  \n avg_degree_fundings | 1.0752806601639344E8 \n-RECORD 1-----------------------------------\n degree_type         | MD                   \n avg_degree_fundings | 8.356373994617563E7  \n-RECORD 2-----------------------------------\n degree_type         | Degree               \n avg_degree_fundings | 7.788771537234043E7  \n-RECORD 3-----------------------------------\n degree_type         | PhD                  \n avg_degree_fundings | 7.293356602564102E7  \n-RECORD 4-----------------------------------\n degree_type         | BE                   \n avg_degree_fundings | 7.270905695121951E7  \n-RECORD 5-----------------------------------\n degree_type         | JD                   \n avg_degree_fundings | 7.239109696745117E7  \n-RECORD 6-----------------------------------\n degree_type         | MBA                  \n avg_degree_fundings | 6.799778325609438E7  \n-RECORD 7-----------------------------------\n degree_type         | BA                   \n avg_degree_fundings | 6.3007446477968976E7 \n-RECORD 8-----------------------------------\n degree_type         | BTECH                \n avg_degree_fundings | 6.090355454517611E7  \n-RECORD 9-----------------------------------\n degree_type         | Bachelors Degree    \n avg_degree_fundings | 5.924521029257642E7  \nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1683765972350_-2031250882","id":"20230511-004612_96500432","dateCreated":"2023-05-11T00:46:12+0000","dateStarted":"2023-05-11T01:49:18+0000","dateFinished":"2023-05-11T01:49:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30634"},{"text":"spark.sql('''\nSELECT year(from_unixtime(funded_at / 1000)) AS year, SUM(raised_amount) AS sum_raised\nFROM projectdb.funds\nWHERE raised_currency_code = 'USD'\nGROUP BY year\nORDER BY year\n''').show(10, vertical=True)","user":"anonymous","dateUpdated":"2023-05-11T02:24:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"... ... ... ... ... ... -RECORD 0---------------\n year       | null      \n sum_raised | 5.39155E9 \n-RECORD 1---------------\n year       | 1975      \n sum_raised | 6.5E8     \n-RECORD 2---------------\n year       | 1984      \n sum_raised | 2.8E7     \n-RECORD 3---------------\n year       | 1987      \n sum_raised | 6.5E7     \n-RECORD 4---------------\n year       | 1989      \n sum_raised | 9000000.0 \n-RECORD 5---------------\n year       | 1990      \n sum_raised | 2.4E8     \n-RECORD 6---------------\n year       | 1991      \n sum_raised | 7.5E7     \n-RECORD 7---------------\n year       | 1993      \n sum_raised | 3.1E7     \n-RECORD 8---------------\n year       | 1994      \n sum_raised | 1.3E8     \n-RECORD 9---------------\n year       | 1996      \n sum_raised | 3.07E8    \nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1683763387270_1989311135","id":"20230511-000307_2021934242","dateCreated":"2023-05-11T00:03:07+0000","dateStarted":"2023-05-11T02:24:50+0000","dateFinished":"2023-05-11T02:24:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30635"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683764406311_-1004192959","id":"20230511-002006_1107204436","dateCreated":"2023-05-11T00:20:06+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:30636","errorMessage":""}],"name":"eda","id":"2J2JHCH66","angularObjects":{"2CHS8UYQQ:shared_process":[],"2HYECGKYW:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}